package project;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

public class ReportViewer {
	public class SPReportProcess implements ReportProcess{
		final String TARGET_SERVER = "jdbc:sqlserver://sonic612.database.windows.net:1433;";
		final String TARGET_DB = "ChocAn";
		//Declaring JDBC object
		String connString;
		String dbUser;
		String dbPass;
		
		Connection connection;
	    ResultSet resultProvSet;
	    
	    ArrayList<String> report;
	    //SQL queries
	    final String WRITE_STMT = "INSERT INTO dbo.tbl_ProvReport(record_date,Content) VALUES(?,?);";

	  	final String QRY_PROVIDER = "SELECT Prov_Name, Prov_ID, Prov_Address,"
	  					+ "Prov_City, Prov_State,Zip"
	  					+ "\nFROM dbo.tbl_Provider "
	  					+ "\nWHERE Prov_ID = ?;";
	  		
	  	final String QRY_ENCOUNTER = "SELECT Enctr_date,record_date,"
	  				+ " dbo.tbl_Member.Mem_Name,  dbo.tbl_Encounters.Mem_ID, dbo.tbl_Encounters.serv_code, dbo.tbl_Services.SERV_fee"
	  				+ "\nFROM dbo.tbl_Encounters "
	  				+ "\nJOIN dbo.tbl_Member ON dbo.tbl_Encounters.Mem_ID = dbo.tbl_Member.Mem_ID"
	  				+ "\nJOIN dbo.tbl_Services ON dbo.tbl_Encounters.serv_code = dbo.tbl_Services.serv_code"
	  				+ "\nWHERE Prov_ID = ? AND record_date BETWEEN ? AND ?;";
	  		
	  	final String QRY_COUNTER = "SELECT COUNT(UID) AS NumOfEncounters"
	  				+ "\nFROM dbo.tbl_Encounters"
	  				+ "\nWHERE Prov_ID = ? AND record_date BETWEEN ? AND ?;";
	  		
	  	final String QRY_SUM = "SELECT SUM(dbo.tbl_Services.SERV_fee) AS TotalDues"
	  				+ "\nFROM dbo.tbl_Encounters "
	  				+ "\nJOIN dbo.tbl_Services ON dbo.tbl_Encounters.serv_code = dbo.tbl_Services.serv_code"
	  				+ "\nWHERE Prov_ID = ? AND record_date BETWEEN ? AND ?;";
	  	
	  	// Prepared Statements
	    private PreparedStatement Stmt1;
		private PreparedStatement Stmt2;
		private PreparedStatement Stmt3;
		private PreparedStatement Stmt4;
		private PreparedStatement Stmt5;

	    
		// Constructor
	    public SPReportProcess(String user, String password){
	    	init(user,password);
	    }
	    
	    private void init(String user, String password){
	    	this.dbUser = user;
	    	this.dbPass = password;
	    	this.connString = TARGET_SERVER + ";" 
	                + "database="+ TARGET_DB + ";"
	                + "user=" + dbUser + ";"
	                + "password={" + dbPass + "};"
	                + "encrypt=true;"
	                + "trustServerCertificate=false;"
	                + "hostNameInCertificate=*.database.windows.net;"
	                + "loginTimeout=60;";
	  

	    	try {
	            connection = DriverManager.getConnection(connString);
}
